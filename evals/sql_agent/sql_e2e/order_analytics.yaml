suite_name: "Order Analytics"
suite_description: "Tests for order-related analytics and reporting"
default_judge_criteria:
  accuracy_threshold: 8.0
  relevance_threshold: 9.0
  completeness_threshold: 8.0
  hallucination_threshold: 9.0
  require_exact_match: true

tests:
  - name: "orders_with_discounts"
    question: "Find all orders that have products with a discount applied"
    sql: |
      SELECT DISTINCT
        o.order_id,
        o.order_number,
        c.company_name AS customer_name,
        o.order_date
      FROM orders o
      JOIN customers c ON o.customer_id = c.customer_id
      JOIN order_details od ON o.order_id = od.order_id
      WHERE od.discount_percentage > 0
      ORDER BY o.order_date DESC;
    tags: ["distinct", "join", "filtering", "ordering", "orders"]

  - name: "orders_by_status_and_currency"
    question: "What is the breakdown of orders by status and currency?"
    sql: |
      SELECT
        status,
        currency_code,
        COUNT(*) AS order_count,
        SUM(grand_total_amount) AS total_amount
      FROM orders
      GROUP BY status, currency_code
      ORDER BY status, currency_code;
    tags: ["aggregation", "grouping", "ordering", "orders"]

  - name: "average_order_value_monthly"
    question: "What is the average order value by month for the last 6 months?"
    sql: |
      SELECT
        DATE_TRUNC('month', order_date) AS month,
        AVG(grand_total_amount) AS avg_order_value,
        COUNT(*) AS order_count
      FROM orders
      WHERE order_date >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '6 months'
      GROUP BY DATE_TRUNC('month', order_date)
      ORDER BY month DESC;
    tags: ["aggregation", "date_functions", "filtering", "ordering", "orders"]
    judge_criteria:
      accuracy_threshold: 7.0
